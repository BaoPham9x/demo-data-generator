module:
  identifier: "customer_features"
  schema: "demo_fintech"
  table: "fact_customer_features"
  dimensions:
    - column: "feature_name"
      type: "categorical"
      label: "Feature Name"
    - column: "feature_category"
      type: "categorical"
      label: "Feature Category"
    - column: "is_active"
      type: "categorical"
      label: "Is Active"
  metrics:
    - identifier: "feature_activations"
      name: "Feature Activations"
      time: "fact_customer_features.activated_at"
      description: "Total number of feature activations."
      calculation: "count"
      category: "Product"
      dimensions:
        - "feature_name"
        - "feature_category"
        - "dim_customer.customer_tier"
        - "dim_customer.country"
    - identifier: "active_features"
      name: "Active Features"
      time: "fact_customer_features.activated_at"
      description: "Number of currently active features."
      calculation: "count"
      filters:
        - column: "is_active"
          operator: "equals"
          expression: "true"
      category: "Product"
      dimensions:
        - "feature_name"
        - "feature_category"
        - "dim_customer.customer_tier"
    - identifier: "unique_customers_with_features"
      name: "Customers with Features"
      time: "fact_customer_features.activated_at"
      description: "Number of unique customers who have activated at least one feature."
      calculation: "count-distinct"
      distinct_on: "fact_customer_features.customer_key"
      category: "Product"
      dimensions:
        - "feature_name"
        - "feature_category"
    - identifier: "feature_adoption_rate"
      name: "Feature Adoption Rate"
      time: "fact_customer_features.activated_at"
      description: "Percentage of customers who have activated at least one feature."
      calculation: "custom-ratio"
      numerator_sql: "COUNT(DISTINCT fact_customer_features.customer_key)"
      denominator_sql: "(SELECT COUNT(*) FROM dim_customer)"
      format: "percentage"
      category: "Product"
      dimensions:
        - "feature_name"
    - identifier: "avg_features_per_customer"
      name: "Avg Features per Customer"
      time: "fact_customer_features.activated_at"
      description: "Average number of features activated per customer."
      calculation: "custom-value"
      sql_expression: "COUNT(*) / COUNT(DISTINCT fact_customer_features.customer_key)"
      category: "Product"
      dimensions:
        - "dim_customer.customer_tier"
  joinPaths:
    - from:
        column: "customer_key"
      to:
        table: "dim_customer"
        column: "customer_key"
      type: "one-to-many"
