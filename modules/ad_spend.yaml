module:
  identifier: "ad_spend"
  schema: "steep_demo_fintech"
  table: "fact_ad_spend"
  dimensions:
    - column: "network"
      type: "categorical"
      label: "Network"
    - column: "channel"
      type: "categorical"
      label: "Channel"
    - column: "country"
      type: "country"
      label: "Country"
  metrics:
    - identifier: "total_ad_spend"
      name: "Total Ad Spend"
      time: "fact_ad_spend.created_at"
      description: "Total marketing ad spend across all networks."
      calculation: "sum"
      value: "fact_ad_spend.amount"
      category: "Marketing"
      slices:
        - name: "Google"
          filter:
            column: "network"
            operator: "equals"
            expression: "google"
        - name: "Meta"
          filter:
            column: "network"
            operator: "equals"
            expression: "meta"
      dimensions:
        - "network"
        - "channel"
        - "country"
    - identifier: "total_conversions"
      name: "Total Conversions"
      time: "fact_ad_spend.created_at"
      description: "Total customer signups attributed to ad campaigns."
      calculation: "sum"
      value: "fact_ad_spend.conversions"
      category: "Marketing"
      dimensions:
        - "network"
        - "channel"
        - "country"
    - identifier: "cpa"
      name: "Cost per Acquisition (CPA)"
      time: "fact_ad_spend.created_at"
      description: "Average cost per customer acquisition."
      calculation: "custom-ratio"
      numerator_sql: "SUM(fact_ad_spend.amount)"
      denominator_sql: "SUM(fact_ad_spend.conversions)"
      format: "number"
      category: "Marketing"
      dimensions:
        - "network"
        - "channel"
        - "country"
    - identifier: "avg_ad_spend_per_day"
      name: "Avg Ad Spend per Day"
      time: "fact_ad_spend.created_at"
      description: "Average daily ad spend amount."
      calculation: "custom-value"
      sql_expression: "AVG(fact_ad_spend.amount)"
      category: "Marketing"
      dimensions:
        - "network"
        - "channel"
    - identifier: "conversion_rate"
      name: "Conversion Rate"
      time: "fact_ad_spend.created_at"
      description: "Percentage of ad spend that resulted in conversions."
      calculation: "custom-ratio"
      numerator_sql: "SUM(fact_ad_spend.conversions)"
      denominator_sql: "SUM(fact_ad_spend.amount)"
      format: "percentage"
      category: "Marketing"
      dimensions:
        - "network"
        - "channel"
        - "country"