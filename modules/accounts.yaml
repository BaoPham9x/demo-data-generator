module:
  identifier: "accounts"
  schema: "demo_fintech"
  table: "dim_account"
  dimensions:
    - column: "account_type"
      type: "categorical"
      label: "Account Type"
    - column: "account_status"
      type: "categorical"
      label: "Account Status"
    - column: "currency"
      type: "categorical"
      label: "Currency"
  metrics:
    - identifier: "total_accounts"
      name: "Total Accounts"
      time: "dim_account.created_at"
      description: "Total number of accounts created."
      calculation: "count"
      category: "Operations"
      dimensions:
        - "account_type"
        - "account_status"
        - "currency"
        - "dim_customer.customer_tier"
        - "dim_customer.country"
    - identifier: "active_accounts"
      name: "Active Accounts"
      time: "dim_account.created_at"
      description: "Number of active accounts."
      calculation: "count"
      filters:
        - column: "account_status"
          operator: "equals"
          expression: "active"
      category: "Operations"
      dimensions:
        - "account_type"
        - "currency"
        - "dim_customer.customer_tier"
    - identifier: "total_credit_limit"
      name: "Total Credit Limit"
      time: "dim_account.created_at"
      description: "Sum of all credit limits across accounts."
      calculation: "sum"
      value: "dim_account.credit_limit"
      category: "Operations"
      dimensions:
        - "account_type"
        - "currency"
        - "dim_customer.customer_tier"
    - identifier: "avg_credit_limit"
      name: "Avg Credit Limit"
      time: "dim_account.created_at"
      description: "Average credit limit per account."
      calculation: "custom-value"
      sql_expression: "AVG(dim_account.credit_limit)"
      category: "Operations"
      dimensions:
        - "account_type"
        - "currency"
    - identifier: "avg_credit_score"
      name: "Avg Credit Score"
      time: "dim_account.created_at"
      description: "Average credit score across all accounts."
      calculation: "custom-value"
      sql_expression: "AVG(dim_account.credit_score)"
      category: "Operations"
      dimensions:
        - "account_type"
        - "dim_customer.customer_tier"
  joinPaths:
    - from:
        column: "customer_id"
      to:
        table: "dim_customer"
        column: "customer_id"
      type: "many-to-one"
